{
    "contents" : "---\ntitle: \"Reproducible Research Project 1\"\noutput: html_document\n---\n\nRequired packages\nplyr\n\n\nLoading and preprocessing the data:\n```{r}\nunzip(\"./repdata-data-activity.zip\")\nactivity<-read.csv(\"./activity.csv\")\n```\n\n\nWhat is the total number of steps taken per day?\n```{r}\nlibrary(plyr)\nstep_sum_mean<-ddply(activity,~date, summarize, sum=sum(steps, na.rm=FALSE), mean=mean(steps, na.rm=TRUE))\nstep_sum<-sum(step_sum_mean$sum, na.rm=TRUE)\nstep_mean<-mean(step_sum_mean$mean, na.rm=TRUE)\n```\n\nThe total number of steps taken per day (sum) and the mean steps are listed below:\n```{r, echo=FALSE}\nstep_sum_mean\n```\n\nThe total number of steps taken on all days is listed below:\n```{r, echo=FALSE}\nstep_sum\n```\n\n\nThe mean number of steps taken across all days is listed below:\n```{r, echo=FALSE}\nstep_mean\n```\n\nHistogram of the total number of steps per day:\n```{r, echo=FALSE}\nhist(step_sum_mean$sum, breaks=20, col=\"red\", main= \"Distribution of Total Number of Steps per Day\",\n     xlab=\"Total Number of Steps per Day\",\n     ylab=\"Frequency (Days)\")\n```\n\nCalculate the mean and median of the total number of steps per day:\n```{r}\nmean_median_activity<-ddply(activity, ~date, summarize, mean=mean(steps, na.rm=TRUE), median=median(steps,na.rm=TRUE))\nmedian_activity<-median(activity$steps, na.rm=TRUE)\n```\n\nThe mean and median steps per day are listed below:\n```{r, echo=FALSE}\nmean_median_activity\n```\n\nThe median steps across all days are listed below:\n```{r, echo=FALSE}\nmedian_activity\n```\n\nThe mean number of steps taken across all days is listed below:\n```{r, echo=FALSE}\nstep_mean\n```\n\nWhat is the average daily activity pattern?\n\nTime series plot of the 5-minute interval and average number of steps taken, averaged across all days\n```{r}\nstep_sum_by_interval<-ddply(activity,~interval, summarize, mean=mean(steps,na.rm=TRUE))\n```\n```{r, echo=FALSE}\nplot(step_sum_by_interval$interval, step_sum_by_interval$mean, type=\"l\",\n     xlab=\"5 minute interval\", ylab=\"Mean Number of Steps\")\n```\n\nThe highest level of activity occurs between interval 600 and interval 1000\n\nWhich 5-min interval, on average across all days, contains the maximum number of steps?\n```{r}\nmax_interval<-which.max(step_sum_by_interval$mean)\n```\n\nThe 5-min interval that contains the maximum number of steps is listed below:\n```{r, echo=FALSE}\nmax_interval\n```\n\nInputting missing values\n\nCalculate and report the total number of missing values in the dataset.\n```{r}\nNAsum<-sum(length(which(is.na(activity$steps))))\n```\n\nThe total number of missing values in the dataset is listed below:\n```{r, echo=FALSE}\nNAsum\n```\n\n\nFill in all missing values (coded as NA) in the dataset yielding a new, equal dataset called NAreplace_activity.\n```{r}\nNAreplace_activity<-activity\nfor (i in 1:nrow(NAreplace_activity)) {\n  if (is.na(NAreplace_activity$steps[i])) {\n    NAreplace_activity$steps[i]<-step_sum_by_interval[which(NAreplace_activity$interval[i]==step_sum_by_interval$interval), ]$mean\n  }\n}\n```\n\nMake a histogram of the total number of steps taken each day and calculate and report the mean and median total number of steps taken per day in NAreplace_activity.  \n```{r, echo=FALSE}\nhist(step_sum_mean$sum, breaks=20, col=\"red\", main= \"Distribution of Total Number of Steps\",\n     xlab=\"Total Number of Steps in a Day\",\n     ylab=\"Frequency in Days\")\n```\n\n\nCalculate and report the mean and median total number of steps taken per day in the new data set in which the NAs have been replaced.\n\n```{r}\nmean_median_NAreplace<-ddply(NAreplace_activity, ~date, summarize, mean=mean(steps), median=median(steps))\nmeanNAreplace<-mean(NAreplace_activity$steps)\nmedianNAreplace<-median(NAreplace_activity$steps)\nsumStepsNAreplace<-sum(NAreplace_activity$steps)\nsumStepsNAreplace_daily<-ddply(NAreplace_activity, ~date, summarize, NAreplace_steps=sum(steps))\n```\n\nThe mean and median of the new data set in which the NAs have been replaced are listed below:\n```{r, echo=FALSE}\nmean_median_NAreplace\n```\n\nThe mean across all days is listed below:\n```{r}\nmeanNAreplace\n```\n\nThe median across all days is listed below:\n```{r}\nmedianNAreplace\n```\n\n\nDo these values differ from the estimates from the first part of the assignment?\nAnswer: These values do not appear to be different.\n\nWhat is the impact of imputing missing data on the estimates of the total daily number of steps?\n\nThe total number of steps per day in the original activity data compared to the step sums in the new data set with NAs removed is listed below:\n```{r, echo=FALSE}\ncbind(step_sum_mean$date, step_sum_mean$sum, sumStepsNAreplace_daily$NAreplace_steps) \n```\n\nAre there differences in activity patterns between weekdays and weekends?\n\nAnswer: The only differences seem to exist where NAs were previously present in the original dataset, otherwise the values appear to be identical\n\nCreate a new factor variable in the dataset with two levels-\"weekday\" and \"weekend\" indicating whether a given date is a weekday or weekend day.\n```{r}\nactivity$date<-as.POSIXct(activity$date)\nactivity$WeekDay<-weekdays(activity$date)\nactivity$DayFactor<-ifelse(activity$WeekDay%in%c(\"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\"), \"weekday\", \"weekend\")\n```\n\nMake time-series plots of the 5-minute activity intervals and average number of steps taken to compare weekday and weekend activity. \n```{r}\nweekday_activity<-activity[activity$DayFactor==\"weekday\",]\nweekday_activity<-ddply(weekday_activity, ~interval, summarize, mean=mean(steps, na.rm=TRUE))\n\nweekend_activity<-activity[activity$DayFactor==\"weekend\",]\nweekend_activity<-ddply(weekend_activity, ~interval, summarize, mean=mean(steps, na.rm=TRUE))\n```\n\n```{r, echo=FALSE}\npar(mfrow=c(2,1))\nplot(weekend_activity$interval, weekend_activity$mean, type=\"l\", main=\"Weekend Activity\", xlab=\"5 min Interval \", ylab=\"Mean Steps\")\nplot(weekday_activity$interval, weekday_activity$mean, type=\"l\", main=\"Weekday Activity\", xlab=\"5 min Interval\", ylab=\"Mean Steps\")\n```",
    "created" : 1442694645674.000,
    "dirty" : true,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2811381613",
    "id" : "C1B1E47",
    "lastKnownWriteTime" : 1442700943,
    "path" : "~/RepData_PeerAssessment1/PA1_template.Rmd",
    "project_path" : "PA1_template.Rmd",
    "properties" : {
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "type" : "r_markdown"
}